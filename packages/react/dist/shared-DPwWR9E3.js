"use strict";const k=require("livekit-client"),V=require("react"),S=require("./shared-CVy2Ouqp.js"),f=require("./shared-I8hFcrmp.js");function ct(t){const a=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const n in t)if(n!=="default"){const r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(a,n,r.get?r:{enumerable:!0,get:()=>t[n]})}}return a.default=t,Object.freeze(a)}const e=ct(V);function lt(t){const a=s=>typeof window<"u"?window.matchMedia(s).matches:!1,[n,r]=e.useState(a(t));function c(){r(a(t))}return e.useEffect(()=>{const s=window.matchMedia(t);return c(),s.addListener?s.addListener(c):s.addEventListener("change",c),()=>{s.removeListener?s.removeListener(c):s.removeEventListener("change",c)}},[t]),n}const Ce=e.createContext(void 0);function Me(t){const a=e.useContext(Ce);if(t===!0){if(a)return a;throw Error("tried to access feature context, but none is present")}return a}const le=e.forwardRef(function(a,n){const{mergedProps:r}=f.useChatToggle({props:a});return e.createElement("button",{ref:n,...r},a.children)}),ie=e.forwardRef(function(a,n){const{buttonProps:r}=f.useDisconnectButton(a);return e.createElement("button",{ref:n,...r},a.children)}),Te=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},e.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),e.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),ye=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},e.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),Re=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,viewBox:"0 0 24 24",...t},e.createElement("path",{fill:"#FFF",d:"M4.99 3.99a1 1 0 0 0-.697 1.717L10.586 12l-6.293 6.293a1 1 0 1 0 1.414 1.414L12 13.414l6.293 6.293a1 1 0 1 0 1.414-1.414L13.414 12l6.293-6.293a1 1 0 0 0-.727-1.717 1 1 0 0 0-.687.303L12 10.586 5.707 4.293a1 1 0 0 0-.717-.303z"})),Ie=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none",...t},e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),re=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},e.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M5.293 2.293a1 1 0 0 1 1.414 0l4.823 4.823a1.25 1.25 0 0 1 0 1.768l-4.823 4.823a1 1 0 0 1-1.414-1.414L9.586 8 5.293 3.707a1 1 0 0 1 0-1.414z",clipRule:"evenodd"})),Pe=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},e.createElement("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},e.createElement("path",{d:"M10 1.75h4.25m0 0V6m0-4.25L9 7M6 14.25H1.75m0 0V10m0 4.25L7 9"}))),Ne=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},e.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M8.961.894C8.875-.298 7.125-.298 7.04.894c-.066.912-1.246 1.228-1.76.472-.67-.99-2.186-.115-1.664.96.399.824-.465 1.688-1.288 1.289-1.076-.522-1.95.994-.961 1.665.756.513.44 1.693-.472 1.759-1.192.086-1.192 1.836 0 1.922.912.066 1.228 1.246.472 1.76-.99.67-.115 2.186.96 1.664.824-.399 1.688.465 1.289 1.288-.522 1.076.994 1.95 1.665.961.513-.756 1.693-.44 1.759.472.086 1.192 1.836 1.192 1.922 0 .066-.912 1.246-1.228 1.76-.472.67.99 2.186.115 1.664-.96-.399-.824.465-1.688 1.288-1.289 1.076.522 1.95-.994.961-1.665-.756-.513-.44-1.693.472-1.759 1.192-.086 1.192-1.836 0-1.922-.912-.066-1.228-1.246-.472-1.76.99-.67.115-2.186-.96-1.664-.824.399-1.688-.465-1.289-1.288.522-1.076-.994-1.95-1.665-.961-.513.756-1.693.44-1.759-.472ZM8 13A5 5 0 1 0 8 3a5 5 0 0 0 0 10Z",clipRule:"evenodd"})),xe=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),Le=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},e.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M4 6.104V4a4 4 0 1 1 8 0v2.104c1.154.326 2 1.387 2 2.646v4.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-4.5c0-1.259.846-2.32 2-2.646ZM5.5 4a2.5 2.5 0 0 1 5 0v2h-5V4Z",clipRule:"evenodd"})),Ae=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},e.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),e.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),Ve=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},e.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),e.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),Fe=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...t},e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),De=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...t},e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("g",{opacity:.25},e.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),ze=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...t},e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("g",{opacity:.25},e.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),Oe=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},e.createElement("g",{opacity:.25},e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),oe=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none",...t},e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),$e=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none",...t},e.createElement("g",{fill:"currentColor"},e.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),e.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),ce=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 0a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0V.75A.75.75 0 0 1 8 0Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 12a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-2.5A.75.75 0 0 1 8 12Z",clipRule:"evenodd",opacity:.7}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 1.072a.75.75 0 0 1 .274 1.024l-1.25 2.165a.75.75 0 0 1-1.299-.75l1.25-2.165A.75.75 0 0 1 12 1.072Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M6 11.464a.75.75 0 0 1 .274 1.025l-1.25 2.165a.75.75 0 0 1-1.299-.75l1.25-2.165A.75.75 0 0 1 6 11.464Z",clipRule:"evenodd",opacity:.6}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M14.928 4a.75.75 0 0 1-.274 1.025l-2.165 1.25a.75.75 0 1 1-.75-1.3l2.165-1.25A.75.75 0 0 1 14.928 4Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4.536 10a.75.75 0 0 1-.275 1.024l-2.165 1.25a.75.75 0 0 1-.75-1.298l2.165-1.25A.75.75 0 0 1 4.536 10Z",clipRule:"evenodd",opacity:.5}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M16 8a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 16 8Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4 8a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 4 8Z",clipRule:"evenodd",opacity:.4}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M14.928 12a.75.75 0 0 1-1.024.274l-2.165-1.25a.75.75 0 0 1 .75-1.299l2.165 1.25A.75.75 0 0 1 14.928 12Z",clipRule:"evenodd",opacity:.9}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4.536 6a.75.75 0 0 1-1.025.275l-2.165-1.25a.75.75 0 1 1 .75-1.3l2.165 1.25A.75.75 0 0 1 4.536 6Z",clipRule:"evenodd",opacity:.3}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 14.928a.75.75 0 0 1-1.024-.274l-1.25-2.165a.75.75 0 0 1 1.298-.75l1.25 2.165A.75.75 0 0 1 12 14.928Z",clipRule:"evenodd",opacity:.8}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M6 4.536a.75.75 0 0 1-1.024-.275l-1.25-2.165a.75.75 0 1 1 1.299-.75l1.25 2.165A.75.75 0 0 1 6 4.536Z",clipRule:"evenodd",opacity:.2})),Ze=t=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},e.createElement("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},e.createElement("path",{d:"M13.25 7H9m0 0V2.75M9 7l5.25-5.25M2.75 9H7m0 0v4.25M7 9l-5.25 5.25"}))),_e=e.forwardRef(function({trackRef:a,...n},r){const c=f.useMaybeTrackRefContext(),{mergedProps:s,inFocus:u}=f.useFocusToggle({trackRef:a??c,props:n});return e.createElement(f.LayoutContext.Consumer,null,l=>l!==void 0&&e.createElement("button",{ref:r,...s},n.children?n.children:u?e.createElement(Ze,null):e.createElement(Pe,null)))}),G=e.forwardRef(function({kind:a,initialSelection:n,onActiveDeviceChange:r,onDeviceListChange:c,onDeviceSelectError:s,exactMatch:u,track:l,requestPermissions:i,onError:v,...o},p){const m=S.useMaybeRoomContext(),w=e.useRef("default"),h=e.useCallback(T=>{m&&m.emit(k.RoomEvent.MediaDevicesError,T),v==null||v(T)},[m,v]),{devices:g,activeDeviceId:d,setActiveMediaDevice:C,className:E}=f.useMediaDeviceSelect({kind:a,room:m,track:l,requestPermissions:i,onError:h});e.useEffect(()=>{n!==void 0&&C(n)},[C]),e.useEffect(()=>{typeof c=="function"&&c(g)},[c,g]),e.useEffect(()=>{d!==w.current&&(r==null||r(d)),w.current=d},[d]);const I=async T=>{try{await C(T,{exact:u??!0})}catch(P){if(P instanceof Error)s==null||s(P);else throw P}},R=e.useMemo(()=>f.mergeProps$1(o,{className:E},{className:"lk-list"}),[E,o]),b=!!g.find(T=>T.label.toLowerCase().startsWith("default"));function M(T,P,z){return T===P||!b&&z===0&&P==="default"}return e.createElement("ul",{ref:p,...R},g.map((T,P)=>e.createElement("li",{key:T.deviceId,id:T.deviceId,"data-lk-active":M(T.deviceId,d,P),"aria-selected":M(T.deviceId,d,P),role:"option"},e.createElement("button",{className:"lk-button",onClick:()=>I(T.deviceId)},T.label))))}),se=e.forwardRef(function({label:a,...n},r){const c=S.useRoomContext(),{mergedProps:s,canPlayAudio:u}=f.useStartAudio({room:c,props:n}),{mergedProps:l,canPlayVideo:i}=f.useStartVideo({room:c,props:s}),{style:v,...o}=l;return v.display=u&&i?"none":"block",e.createElement("button",{ref:r,style:v,...o},a??`Включить ${u?"Видео":"Звук"}`)});function je(t,a){switch(t){case k.Track.Source.Microphone:return a?e.createElement(Ve,null):e.createElement(Ae,null);case k.Track.Source.Camera:return a?e.createElement(ye,null):e.createElement(Te,null);case k.Track.Source.ScreenShare:return a?e.createElement($e,null):e.createElement(oe,null);default:return}}function it(t){switch(t){case k.ConnectionQuality.Excellent:return e.createElement(Fe,null);case k.ConnectionQuality.Good:return e.createElement(De,null);case k.ConnectionQuality.Poor:return e.createElement(ze,null);default:return e.createElement(Oe,null)}}const Z=e.forwardRef(function({showIcon:a,...n},r){const{buttonProps:c,enabled:s}=f.useTrackToggle(n),[u,l]=e.useState(!1);return e.useEffect(()=>{l(!0)},[]),u&&e.createElement("button",{ref:r,...c},(a??!0)&&je(n.source,s),n.children)}),ue=e.forwardRef(function(a,n){const{className:r,quality:c}=f.useConnectionQualityIndicator(a),s=e.useMemo(()=>({...f.mergeProps$1(a,{className:r}),"data-lk-quality":c}),[c,a,r]);return e.createElement("div",{ref:n,...s},a.children??it(c))}),K=e.forwardRef(function({participant:a,...n},r){const c=f.useEnsureParticipant(a),{className:s,infoObserver:u}=e.useMemo(()=>S.setupParticipantName(c),[c]),{identity:l,name:i}=f.useObservableState(u,{name:c.name,identity:c.identity,metadata:c.metadata}),v=e.useMemo(()=>f.mergeProps$1(n,{className:s,"data-lk-participant-name":i}),[n,s,i]);return e.createElement("span",{ref:r,...v},i!==""?i:l,n.children)}),de=e.forwardRef(function({trackRef:a,show:n="always",...r},c){const{className:s,isMuted:u}=f.useTrackMutedIndicator(a),l=n==="always"||n==="muted"&&u||n==="unmuted"&&!u,i=e.useMemo(()=>f.mergeProps$1(r,{className:s}),[s,r]);return l?e.createElement("div",{ref:c,...i,"data-lk-muted":u},r.children??je(a.source,!u)):null}),me=t=>e.createElement("svg",{width:320,height:320,viewBox:"0 0 320 320",preserveAspectRatio:"xMidYMid meet",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},e.createElement("path",{d:"M160 180C204.182 180 240 144.183 240 100C240 55.8172 204.182 20 160 20C115.817 20 79.9997 55.8172 79.9997 100C79.9997 144.183 115.817 180 160 180Z",fill:"white",fillOpacity:.25}),e.createElement("path",{d:"M97.6542 194.614C103.267 191.818 109.841 192.481 115.519 195.141C129.025 201.466 144.1 205 159.999 205C175.899 205 190.973 201.466 204.48 195.141C210.158 192.481 216.732 191.818 222.345 194.614C262.703 214.719 291.985 253.736 298.591 300.062C300.15 310.997 291.045 320 280 320H39.9997C28.954 320 19.8495 310.997 21.4087 300.062C28.014 253.736 57.2966 214.72 97.6542 194.614Z",fill:"white",fillOpacity:.25}));function Be(t,a={}){const[n,r]=e.useState(S.getTrackByIdentifier(t)),[c,s]=e.useState(n==null?void 0:n.isMuted),[u,l]=e.useState(n==null?void 0:n.isSubscribed),[i,v]=e.useState(n==null?void 0:n.track),[o,p]=e.useState("landscape"),m=e.useRef(),{className:w,trackObserver:h}=e.useMemo(()=>S.setupMediaTrack(t),[t.participant.sid??t.participant.identity,t.source,S.isTrackReference(t)&&t.publication.trackSid]);return e.useEffect(()=>{const g=h.subscribe(d=>{S.log.debug("update track",d),r(d),s(d==null?void 0:d.isMuted),l(d==null?void 0:d.isSubscribed),v(d==null?void 0:d.track)});return()=>g==null?void 0:g.unsubscribe()},[h]),e.useEffect(()=>{var g,d;return i&&(m.current&&i.detach(m.current),(g=a.element)!=null&&g.current&&!(t.participant.isLocal&&(i==null?void 0:i.kind)==="audio")&&i.attach(a.element.current)),m.current=(d=a.element)==null?void 0:d.current,()=>{m.current&&(i==null||i.detach(m.current))}},[i,a.element]),e.useEffect(()=>{var g,d;if(typeof((g=n==null?void 0:n.dimensions)==null?void 0:g.width)=="number"&&typeof((d=n==null?void 0:n.dimensions)==null?void 0:d.height)=="number"){const C=n.dimensions.width>n.dimensions.height?"landscape":"portrait";p(C)}},[n]),{publication:n,isMuted:c,isSubscribed:u,track:i,elementProps:f.mergeProps$1(a.props,{className:w,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":n==null?void 0:n.source,...(n==null?void 0:n.kind)==="video"&&{"data-lk-orientation":o}})}}var ae,ke;function ot(){if(ke)return ae;ke=1;var t="Expected a function",a=NaN,n="[object Symbol]",r=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt,i=typeof S.commonjsGlobal=="object"&&S.commonjsGlobal&&S.commonjsGlobal.Object===Object&&S.commonjsGlobal,v=typeof self=="object"&&self&&self.Object===Object&&self,o=i||v||Function("return this")(),p=Object.prototype,m=p.toString,w=Math.max,h=Math.min,g=function(){return o.Date.now()};function d(b,M,T){var P,z,y,x,F,O,D=0,_=!1,L=!1,q=!0;if(typeof b!="function")throw new TypeError(t);M=R(M)||0,C(T)&&(_=!!T.leading,L="maxWait"in T,y=L?w(R(T.maxWait)||0,M):y,q="trailing"in T?!!T.trailing:q);function j(A){var $=P,Q=z;return P=z=void 0,D=A,x=b.apply(Q,$),x}function ee(A){return D=A,F=setTimeout(H,M),_?j(A):x}function te(A){var $=A-O,Q=A-D,Ee=M-$;return L?h(Ee,y-Q):Ee}function B(A){var $=A-O,Q=A-D;return O===void 0||$>=M||$<0||L&&Q>=y}function H(){var A=g();if(B(A))return N(A);F=setTimeout(H,te(A))}function N(A){return F=void 0,q&&P?j(A):(P=z=void 0,x)}function W(){F!==void 0&&clearTimeout(F),D=0,P=O=z=F=void 0}function rt(){return F===void 0?x:N(g())}function ne(){var A=g(),$=B(A);if(P=arguments,z=this,O=A,$){if(F===void 0)return ee(O);if(L)return F=setTimeout(H,M),j(O)}return F===void 0&&(F=setTimeout(H,M)),x}return ne.cancel=W,ne.flush=rt,ne}function C(b){var M=typeof b;return!!b&&(M=="object"||M=="function")}function E(b){return!!b&&typeof b=="object"}function I(b){return typeof b=="symbol"||E(b)&&m.call(b)==n}function R(b){if(typeof b=="number")return b;if(I(b))return a;if(C(b)){var M=typeof b.valueOf=="function"?b.valueOf():b;b=C(M)?M+"":M}if(typeof b!="string")return b===0?b:+b;b=b.replace(r,"");var T=s.test(b);return T||u.test(b)?l(b.slice(2),T?2:8):c.test(b)?a:+b}return ae=d,ae}var st=ot();const Se=S.getDefaultExportFromCjs(st);function ut(t){const a=V.useRef(t);a.current=t,V.useEffect(()=>()=>{a.current()},[])}function dt(t,a=500,n){const r=V.useRef();ut(()=>{r.current&&r.current.cancel()});const c=V.useMemo(()=>{const s=Se(t,a,n),u=(...l)=>s(...l);return u.cancel=()=>{s.cancel()},u.isPending=()=>!!r.current,u.flush=()=>s.flush(),u},[t,a,n]);return V.useEffect(()=>{r.current=Se(t,a,n)},[t,a,n]),c}function mt(t,a,n){const r=((v,o)=>v===o),c=t instanceof Function?t():t,[s,u]=V.useState(c),l=V.useRef(c),i=dt(u,a,n);return r(l.current,c)||(i(c),l.current=c),[s,i]}function ft({threshold:t=0,root:a=null,rootMargin:n="0%",freezeOnceVisible:r=!1,initialIsIntersecting:c=!1,onChange:s}={}){var u;const[l,i]=V.useState(null),[v,o]=V.useState(()=>({isIntersecting:c,entry:void 0})),p=V.useRef();p.current=s;const m=((u=v.entry)==null?void 0:u.isIntersecting)&&r;V.useEffect(()=>{if(!l||!("IntersectionObserver"in window)||m)return;const g=new IntersectionObserver(d=>{const C=Array.isArray(g.thresholds)?g.thresholds:[g.thresholds];d.forEach(E=>{const I=E.isIntersecting&&C.some(R=>E.intersectionRatio>=R);o({isIntersecting:I,entry:E}),p.current&&p.current(I,E)})},{threshold:t,root:a,rootMargin:n});return g.observe(l),()=>{g.disconnect()}},[l,JSON.stringify(t),a,n,m,r]);const w=V.useRef(null);V.useEffect(()=>{var g;!l&&((g=v.entry)!=null&&g.target)&&!r&&!m&&w.current!==v.entry.target&&(w.current=v.entry.target,o({isIntersecting:c,entry:void 0}))},[l,v.entry,r,m,c]);const h=[i,!!v.isIntersecting,v.entry];return h.ref=h[0],h.isIntersecting=h[1],h.entry=h[2],h}const He=e.forwardRef(function({onTrackClick:a,onClick:n,onSubscriptionStatusChanged:r,trackRef:c,manageSubscription:s,...u},l){const i=f.useEnsureTrackRef(c),v=e.useRef(null);e.useImperativeHandle(l,()=>v.current);const o=ft({root:v.current}),[p]=mt(o,3e3);e.useEffect(()=>{s&&i.publication instanceof k.RemoteTrackPublication&&(p==null?void 0:p.isIntersecting)===!1&&(o==null?void 0:o.isIntersecting)===!1&&i.publication.setSubscribed(!1)},[p,i,s]),e.useEffect(()=>{s&&i.publication instanceof k.RemoteTrackPublication&&(o==null?void 0:o.isIntersecting)===!0&&i.publication.setSubscribed(!0)},[o,i,s]);const{elementProps:m,publication:w,isSubscribed:h}=Be(i,{element:v,props:u});e.useEffect(()=>{r==null||r(!!h)},[h,r]);const g=d=>{n==null||n(d),a==null||a({participant:i==null?void 0:i.participant,track:w})};return e.createElement("video",{ref:v,...m,muted:!0,onClick:g})}),X=e.forwardRef(function({trackRef:a,onSubscriptionStatusChanged:n,volume:r,...c},s){const u=f.useEnsureTrackRef(a),l=e.useRef(null);e.useImperativeHandle(s,()=>l.current);const{elementProps:i,isSubscribed:v,track:o,publication:p}=Be(u,{element:l,props:c});return e.useEffect(()=>{n==null||n(!!v)},[v,n]),e.useEffect(()=>{o===void 0||r===void 0||(o instanceof k.RemoteAudioTrack?o.setVolume(r):S.log.warn("Volume can only be set on remote audio tracks."))},[r,o]),e.useEffect(()=>{p===void 0||c.muted===void 0||(p instanceof k.RemoteTrackPublication?p.setEnabled(!c.muted):S.log.warn("Can only call setEnabled on remote track publications."))},[c.muted,p,o]),e.createElement("audio",{ref:l,...i})});function Ue(t){const a=!!f.useMaybeParticipantContext();return t.participant&&!a?e.createElement(f.ParticipantContext.Provider,{value:t.participant},t.children):e.createElement(e.Fragment,null,t.children)}function qe(t){const a=!!f.useMaybeTrackRefContext();return t.trackRef&&!a?e.createElement(f.TrackRefContext.Provider,{value:t.trackRef},t.children):e.createElement(e.Fragment,null,t.children)}const J=e.forwardRef(function({trackRef:a,children:n,onParticipantClick:r,disableSpeakingIndicator:c,...s},u){var w,h;const l=f.useEnsureTrackRef(a),{elementProps:i}=f.useParticipantTile({htmlProps:s,disableSpeakingIndicator:c,onParticipantClick:r,trackRef:l}),v=f.useIsEncrypted(l.participant),o=f.useMaybeLayoutContext(),p=(w=Me())==null?void 0:w.autoSubscription,m=e.useCallback(g=>{l.source&&!g&&o&&o.pin.dispatch&&S.isTrackReferencePinned(l,o.pin.state)&&o.pin.dispatch({msg:"clear_pin"})},[l,o]);return e.createElement("div",{ref:u,style:{position:"relative"},...i},e.createElement(qe,{trackRef:l},e.createElement(Ue,{participant:l.participant},n??e.createElement(e.Fragment,null,S.isTrackReference(l)&&(((h=l.publication)==null?void 0:h.kind)==="video"||l.source===k.Track.Source.Camera||l.source===k.Track.Source.ScreenShare)?e.createElement(He,{trackRef:l,onSubscriptionStatusChanged:m,manageSubscription:p}):S.isTrackReference(l)&&e.createElement(X,{trackRef:l,onSubscriptionStatusChanged:m}),e.createElement("div",{className:"lk-participant-placeholder"},e.createElement(me,null)),e.createElement("div",{className:"lk-participant-metadata"},e.createElement("div",{className:"lk-participant-metadata-item"},l.source===k.Track.Source.Camera?e.createElement(e.Fragment,null,v&&e.createElement(Le,{style:{marginRight:"0.25rem"}}),e.createElement(de,{trackRef:{participant:l.participant,source:k.Track.Source.Microphone},show:"muted"}),e.createElement(K,null)):e.createElement(e.Fragment,null,e.createElement(oe,{style:{marginRight:"0.25rem"}}),e.createElement(K,null,"'s screen"))),e.createElement(ue,{className:"lk-participant-metadata-item"}))),e.createElement(_e,{trackRef:l}))))});function We(t){const a=f.mergeProps$1(t,{className:"lk-focus-layout"});return e.createElement("div",{...a},t.children)}function Qe({trackRef:t,...a}){return e.createElement(J,{trackRef:t,...a})}function Y({tracks:t,...a}){return e.createElement(e.Fragment,null,t.map(n=>e.createElement(f.TrackRefContext.Provider,{value:n,key:S.getTrackReferenceId(n)},f.cloneSingleChild(a.children))))}function ht({totalPageCount:t,nextPage:a,prevPage:n,currentPage:r,pagesContainer:c}){const[s,u]=e.useState(!1);return e.useEffect(()=>{let l;return c&&(l=S.createInteractingObservable(c.current,2e3).subscribe(u)),()=>{l&&l.unsubscribe()}},[c]),e.createElement("div",{className:"lk-pagination-control","data-lk-user-interaction":s},e.createElement("button",{className:"lk-button",onClick:n},e.createElement(re,null)),e.createElement("span",{className:"lk-pagination-count"},`${r} of ${t}`),e.createElement("button",{className:"lk-button",onClick:a},e.createElement(re,null)))}const gt=e.forwardRef(function({totalPageCount:a,currentPage:n},r){const c=new Array(a).fill("").map((s,u)=>u+1===n?e.createElement("span",{"data-lk-active":!0,key:u}):e.createElement("span",{key:u}));return e.createElement("div",{ref:r,className:"lk-pagination-indicator"},c)});function Ge({tracks:t,...a}){const n=e.createRef(),r=e.useMemo(()=>f.mergeProps$1(a,{className:"lk-grid-layout"}),[a]),{layout:c}=f.useGridLayout(n,t.length),s=f.usePagination(c.maxTiles,t);return f.useSwipe(n,{onLeftSwipe:s.nextPage,onRightSwipe:s.prevPage}),e.createElement("div",{ref:n,"data-lk-pagination":s.totalPageCount>1,...r},e.createElement(Y,{tracks:s.tracks},a.children),t.length>c.maxTiles&&e.createElement(e.Fragment,null,e.createElement(gt,{totalPageCount:s.totalPageCount,currentPage:s.currentPage}),e.createElement(ht,{pagesContainer:n,...s})))}const vt=130,pt=140,we=1,Ke=16/10,Et=(1-Ke)*-1;function Je({tracks:t,orientation:a,...n}){const r=e.useRef(null),[c,s]=e.useState(0),{width:u,height:l}=f.useSize(r),i=a||(l>=u?"vertical":"horizontal"),v=i==="vertical"?Math.max(u*Et,vt):Math.max(l*Ke,pt),o=S.getScrollBarWidth(),p=Math.max(i==="vertical"?(l-o)/v:(u-o)/v,we);let m=Math.round(p);Math.abs(p-c)<.5?m=Math.round(c):c!==p&&s(p);const w=f.useVisualStableUpdate(t,m);return e.useLayoutEffect(()=>{r.current&&(r.current.dataset.lkOrientation=i,r.current.style.setProperty("--lk-max-visible-tiles",m.toString()))},[m,i]),e.createElement("aside",{key:i,className:"lk-carousel",ref:r,...n},e.createElement(Y,{tracks:w},n.children))}function fe({value:t,onPinChange:a,onWidgetChange:n,children:r}){const c=f.useEnsureCreateLayoutContext(t);return e.useEffect(()=>{S.log.debug("PinState Updated",{state:c.pin.state}),a&&c.pin.state&&a(c.pin.state)},[c.pin.state,a]),e.useEffect(()=>{S.log.debug("Widget Updated",{widgetState:c.widget.state}),n&&c.widget.state&&n(c.widget.state)},[n,c.widget.state]),e.createElement(f.LayoutContext.Provider,{value:c},r)}function Xe({room:t,volume:a,muted:n}){const r=f.useTracks([k.Track.Source.Microphone,k.Track.Source.ScreenShareAudio,k.Track.Source.Unknown],{updateOnlyOn:[],onlySubscribed:!0,room:t}).filter(c=>!c.participant.isLocal&&c.publication.kind===k.Track.Kind.Audio);return e.createElement("div",{style:{display:"none"}},r.map(c=>e.createElement(X,{key:S.getTrackReferenceId(c),trackRef:c,volume:a,muted:n})))}function Ye(t){const a=e.useMemo(()=>f.mergeProps$1(t,{className:"lk-toast"}),[t]);return e.createElement("div",{...a},t.children)}const kt=t=>{const a=[];for(let n=0;n<t;n++)a.push([n,t-1-n]);return a},be=t=>[[Math.floor(t/2)],[-1]],St=(t,a,n)=>{const[r,c]=V.useState(0),[s,u]=V.useState([[]]);V.useEffect(()=>{if(t==="thinking")u(be(a));else if(t==="connecting"||t==="initializing"){const i=[...kt(a)];u(i)}else u(t==="listening"?be(a):t===void 0||t==="speaking"?[new Array(a).fill(0).map((i,v)=>v)]:[[]]);c(0)},[t,a]);const l=V.useRef(null);return V.useEffect(()=>{let i=performance.now();const v=o=>{o-i>=n&&(c(m=>m+1),i=o),l.current=requestAnimationFrame(v)};return l.current=requestAnimationFrame(v),()=>{l.current!==null&&cancelAnimationFrame(l.current)}},[n,a,t,s.length]),s[r%s.length]},wt=new Map([["connecting",2e3],["initializing",2e3],["listening",500],["thinking",150]]),bt=(t,a)=>{if(t===void 0)return 1e3;let n=wt.get(t);if(n)switch(t){case"connecting":n/=a;break}return n},he=e.forwardRef(function({state:a,options:n,barCount:r=15,trackRef:c,track:s,children:u,...l},i){const v=f.mergeProps$1(l,{className:"lk-audio-bar-visualizer"});let o=f.useMaybeTrackRefContext();(c||s)&&(o=c||s);const p=f.useMultibandTrackVolume(o,{bands:r,loPass:100,hiPass:200}),m=(n==null?void 0:n.minHeight)??20,w=(n==null?void 0:n.maxHeight)??100,h=St(a,r,bt(a,r)??100);return e.createElement("div",{ref:i,...v,"data-lk-va-state":a},p.map((g,d)=>u?f.cloneSingleChild(u,{"data-lk-highlighted":h.includes(d),"data-lk-bar-index":d,className:"lk-audio-bar",style:{height:`${Math.min(w,Math.max(m,g*100+5))}%`}}):e.createElement("span",{key:d,"data-lk-highlighted":h.includes(d),"data-lk-bar-index":d,className:`lk-audio-bar ${h.includes(d)&&"lk-highlighted"}`,style:{height:`${Math.min(w,Math.max(m,g*100+5))}%`}})))}),et=e.forwardRef(function({children:a,disableSpeakingIndicator:n,onParticipantClick:r,trackRef:c,...s},u){const l=f.useEnsureTrackRef(c),{elementProps:i}=f.useParticipantTile({trackRef:l,htmlProps:s,disableSpeakingIndicator:n,onParticipantClick:r});return e.createElement("div",{ref:u,style:{position:"relative",minHeight:"160px"},...i},e.createElement(f.TrackRefContext.Provider,{value:l},a??e.createElement(e.Fragment,null,S.isTrackReference(l)&&e.createElement(X,{trackRef:l}),e.createElement(he,{barCount:7,options:{minHeight:8}}),e.createElement("div",{className:"lk-participant-metadata"},e.createElement("div",{className:"lk-participant-metadata-item"},e.createElement(de,{trackRef:l}),e.createElement(K,null)),e.createElement(ue,{className:"lk-participant-metadata-item"})))))});function tt(t){const[a,n]=e.useState(void 0),r=f.useConnectionState(t.room);return e.useEffect(()=>{switch(r){case k.ConnectionState.Reconnecting:n(e.createElement(e.Fragment,null,e.createElement(ce,{className:"lk-spinner"})," Повторное подключение"));break;case k.ConnectionState.Connecting:n(e.createElement(e.Fragment,null,e.createElement(ce,{className:"lk-spinner"})," Подключение"));break;case k.ConnectionState.Disconnected:n(e.createElement(e.Fragment,null,"Отключено"));break;default:n(void 0);break}},[r]),a?e.createElement(Ye,{className:"lk-toast-connection-state"},a):e.createElement(e.Fragment,null)}const nt=e.forwardRef(function({entry:a,hideName:n=!1,hideTimestamp:r=!1,messageFormatter:c,...s},u){var m,w,h,g;const l=e.useMemo(()=>c?c(a.message):a.message,[a.message,c]),i=!!a.editTimestamp,v=new Date(a.timestamp),o=typeof navigator<"u"?navigator.language:"en-US",p=((m=a.from)==null?void 0:m.name)??((w=a.from)==null?void 0:w.identity);return e.createElement("li",{ref:u,className:"lk-chat-entry",title:v.toLocaleTimeString(o,{timeStyle:"full"}),"data-lk-message-origin":(h=a.from)!=null&&h.isLocal?"local":"remote",...s},(!r||!n||i)&&e.createElement("span",{className:"lk-meta-data"},!n&&e.createElement("strong",{className:"lk-participant-name"},p),(!r||i)&&e.createElement("span",{className:"lk-timestamp"},i&&"edited ",v.toLocaleTimeString(o,{timeStyle:"short"}))),e.createElement("span",{className:"lk-message-body"},l),e.createElement("span",{className:"lk-message-attachements"},(g=a.attachedFiles)==null?void 0:g.map(d=>d.type.startsWith("image/")&&e.createElement("img",{style:{maxWidth:"300px",maxHeight:"300px"},key:d.name,src:URL.createObjectURL(d),alt:d.name}))))});function Ct(t){return S.tokenize(t,S.createDefaultGrammar()).map((a,n)=>{if(typeof a=="string")return a;{const r=a.content.toString(),c=a.type==="url"?/^http(s?):\/\//.test(r)?r:`https://${r}`:`mailto:${r}`;return e.createElement("a",{className:"lk-chat-link",key:n,href:c,target:"_blank",rel:"noreferrer"},r)}})}function ge({messageFormatter:t,messageDecoder:a,messageEncoder:n,channelTopic:r,...c}){const s=e.useRef(null),u=e.useRef(null),l=e.useMemo(()=>({messageDecoder:a,messageEncoder:n,channelTopic:r}),[a,n,r]),{chatMessages:i,send:v,isSending:o}=f.useChat(l),p=f.useMaybeLayoutContext(),m=e.useRef(0);async function w(h){h.preventDefault(),u.current&&u.current.value.trim()!==""&&(await v(u.current.value),u.current.value="",u.current.focus())}return e.useEffect(()=>{var h;s&&((h=s.current)==null||h.scrollTo({top:s.current.scrollHeight}))},[s,i]),e.useEffect(()=>{var d,C,E,I,R;if(!p||i.length===0)return;if((d=p.widget.state)!=null&&d.showChat&&i.length>0&&m.current!==((C=i[i.length-1])==null?void 0:C.timestamp)){m.current=(E=i[i.length-1])==null?void 0:E.timestamp;return}const h=i.filter(b=>!m.current||b.timestamp>m.current).length,{widget:g}=p;h>0&&((I=g.state)==null?void 0:I.unreadMessages)!==h&&((R=g.dispatch)==null||R.call(g,{msg:"unread_msg",count:h}))},[i,p==null?void 0:p.widget]),e.createElement("div",{...c,className:"lk-chat"},e.createElement("div",{className:"lk-chat-header"},"Сообщения",p&&e.createElement(le,{className:"lk-close-button"},e.createElement(Re,null))),e.createElement("ul",{className:"lk-list lk-chat-messages",ref:s},c.children?i.map((h,g)=>f.cloneSingleChild(c.children,{entry:h,key:h.id??g,messageFormatter:t})):i.map((h,g,d)=>{const C=g>=1&&d[g-1].from===h.from,E=g>=1&&h.timestamp-d[g-1].timestamp<6e4;return e.createElement(nt,{key:h.id??g,hideName:C,hideTimestamp:C===!1?!1:E,entry:h,messageFormatter:t})})),e.createElement("form",{className:"lk-chat-form",onSubmit:w},e.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:o,ref:u,type:"text",placeholder:"Введите сообщение",onInput:h=>h.stopPropagation(),onKeyDown:h=>h.stopPropagation(),onKeyUp:h=>h.stopPropagation()}),e.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:o},"Отправить")))}function U({kind:t,initialSelection:a,onActiveDeviceChange:n,tracks:r,requestPermissions:c=!1,...s}){const[u,l]=e.useState(!1),[i,v]=e.useState([]),[o,p]=e.useState(!0),[m,w]=e.useState(c),h=(E,I)=>{S.log.debug("handle device change"),l(!1),n==null||n(E,I)},g=e.useRef(null),d=e.useRef(null);e.useLayoutEffect(()=>{u&&w(!0)},[u]),e.useLayoutEffect(()=>{let E;return g.current&&d.current&&(i||o)&&(E=S.computeMenuPosition(g.current,d.current,(I,R)=>{d.current&&Object.assign(d.current.style,{left:`${I}px`,top:`${R}px`})})),p(!1),()=>{E==null||E()}},[g,d,i,o]);const C=e.useCallback(E=>{d.current&&E.target!==g.current&&u&&S.wasClickOutside(d.current,E)&&l(!1)},[u,d,g]);return e.useEffect(()=>(document.addEventListener("click",C),()=>{document.removeEventListener("click",C)}),[C]),e.createElement(e.Fragment,null,e.createElement("button",{className:"lk-button lk-button-menu","aria-pressed":u,...s,onClick:()=>l(!u),ref:g},s.children),!s.disabled&&e.createElement("div",{className:"lk-device-menu",ref:d,style:{visibility:u?"visible":"hidden"}},t?e.createElement(G,{initialSelection:a,onActiveDeviceChange:E=>h(t,E),onDeviceListChange:v,kind:t,track:r==null?void 0:r[t],requestPermissions:m}):e.createElement(e.Fragment,null,e.createElement("div",{className:"lk-device-menu-heading"},"Аудио-устройства"),e.createElement(G,{kind:"audioinput",onActiveDeviceChange:E=>h("audioinput",E),onDeviceListChange:v,track:r==null?void 0:r.audioinput,requestPermissions:m}),e.createElement("div",{className:"lk-device-menu-heading"},"Видео-устройства"),e.createElement(G,{kind:"videoinput",onActiveDeviceChange:E=>h("videoinput",E),onDeviceListChange:v,track:r==null?void 0:r.videoinput,requestPermissions:m}))))}function ve(){e.useEffect(()=>{f.warnAboutMissingStyles()},[])}function at(t,a){const[n,r]=e.useState(),c=e.useMemo(()=>new k.Mutex,[]);return e.useEffect(()=>{let s=!1,u=[];return c.lock().then(async l=>{try{(t.audio||t.video)&&(u=await k.createLocalTracks(t),s?u.forEach(i=>i.stop()):r(u))}catch(i){a&&i instanceof Error?a(i):S.log.error(i)}finally{l()}}),()=>{s=!0,u.forEach(l=>{l.stop()})}},[JSON.stringify(t,f.roomOptionsStringifyReplacer),a,c]),n}function Mt(t,a,n){const[r,c]=e.useState(null),[s,u]=e.useState(!1),l=f.useMediaDevices({kind:n}),[i,v]=e.useState(void 0),[o,p]=e.useState(),[m,w]=e.useState(a);e.useEffect(()=>{w(a)},[a]);const h=async(C,E)=>{try{const I=E==="videoinput"?await k.createLocalVideoTrack({deviceId:C,resolution:k.VideoPresets.h720.resolution}):await k.createLocalAudioTrack({deviceId:C}),R=await I.getDeviceId(!1);R&&C!==R&&(d.current=R,w(R)),p(I)}catch(I){I instanceof Error&&c(I)}},g=async(C,E)=>{await C.setDeviceId(E),d.current=E},d=e.useRef(m);return e.useEffect(()=>{t&&!o&&!r&&!s&&(S.log.debug("creating track",n),u(!0),h(m,n).finally(()=>{u(!1)}))},[t,o,r,s]),e.useEffect(()=>{o&&(t?i!=null&&i.deviceId&&d.current!==(i==null?void 0:i.deviceId)?(S.log.debug(`switching ${n} device from`,d.current,i.deviceId),g(o,i.deviceId)):(S.log.debug(`unmuting local ${n} track`),o.unmute()):(S.log.debug(`muting ${n} track`),o.mute().then(()=>S.log.debug(o.mediaStreamTrack))))},[o,i,t,n]),e.useEffect(()=>()=>{o&&(S.log.debug(`stopping local ${n} track`),o.stop(),o.mute())},[]),e.useEffect(()=>{v(l==null?void 0:l.find(C=>C.deviceId===m))},[m,l]),{selectedDevice:i,localTrack:o,deviceError:r}}function Tt({defaults:t={},onValidate:a,onSubmit:n,onError:r,debug:c,joinLabel:s="Войти в комнату",micLabel:u="Микрофон",camLabel:l="Камера",userLabel:i="Имя пользователя",persistUserChoices:v=!0,videoProcessor:o,...p}){const{userChoices:m,saveAudioInputDeviceId:w,saveAudioInputEnabled:h,saveVideoInputDeviceId:g,saveVideoInputEnabled:d,saveUsername:C}=f.usePersistentUserChoices({defaults:t,preventSave:!v,preventLoad:!v}),[E,I]=e.useState(m),[R,b]=e.useState(E.audioEnabled),[M,T]=e.useState(E.videoEnabled),[P,z]=e.useState(E.audioDeviceId),[y,x]=e.useState(E.videoDeviceId),[F,O]=e.useState(E.username);e.useEffect(()=>{h(R)},[R,h]),e.useEffect(()=>{d(M)},[M,d]),e.useEffect(()=>{w(P)},[P,w]),e.useEffect(()=>{g(y)},[y,g]),e.useEffect(()=>{C(F)},[F,C]);const D=at({audio:R?{deviceId:m.audioDeviceId}:!1,video:M?{deviceId:m.videoDeviceId,processor:o}:!1},r),_=e.useRef(null),L=e.useMemo(()=>D==null?void 0:D.filter(N=>N.kind===k.Track.Kind.Video)[0],[D]),q=e.useMemo(()=>{if(L){const{facingMode:N}=k.facingModeFromLocalTrack(L);return N}else return"undefined"},[L]),j=e.useMemo(()=>D==null?void 0:D.filter(N=>N.kind===k.Track.Kind.Audio)[0],[D]);e.useEffect(()=>(_.current&&L&&(L.unmute(),L.attach(_.current)),()=>{L==null||L.detach()}),[L]);const[ee,te]=e.useState(),B=e.useCallback(N=>typeof a=="function"?a(N):N.username!=="",[a]);e.useEffect(()=>{const N={username:F,videoEnabled:M,videoDeviceId:y,audioEnabled:R,audioDeviceId:P};I(N),te(B(N))},[F,M,B,R,P,y]);function H(N){N.preventDefault(),B(E)?typeof n=="function"&&n(E):S.log.warn("Validation failed with: ",E)}return ve(),e.createElement("div",{className:"lk-prejoin",...p},e.createElement("div",{className:"lk-video-container"},L&&e.createElement("video",{ref:_,width:"1280",height:"720","data-lk-facing-mode":q}),(!L||!M)&&e.createElement("div",{className:"lk-camera-off-note"},e.createElement(me,null))),e.createElement("div",{className:"lk-button-group-container"},e.createElement("div",{className:"lk-button-group audio"},e.createElement(Z,{initialState:R,source:k.Track.Source.Microphone,onChange:N=>b(N)},u),e.createElement("div",{className:"lk-button-group-menu"},e.createElement(U,{initialSelection:P,kind:"audioinput",disabled:!j,tracks:{audioinput:j},onActiveDeviceChange:(N,W)=>z(W)}))),e.createElement("div",{className:"lk-button-group video"},e.createElement(Z,{initialState:M,source:k.Track.Source.Camera,onChange:N=>T(N)},l),e.createElement("div",{className:"lk-button-group-menu"},e.createElement(U,{initialSelection:y,kind:"videoinput",disabled:!L,tracks:{videoinput:L},onActiveDeviceChange:(N,W)=>x(W)})))),e.createElement("form",{className:"lk-username-container"},e.createElement("input",{className:"lk-form-control",id:"username",name:"username",type:"text",defaultValue:F,placeholder:i,onChange:N=>O(N.target.value),autoComplete:"off"}),e.createElement("button",{className:"lk-button lk-join-button",type:"submit",onClick:H,disabled:!ee},s)),c&&e.createElement(e.Fragment,null,e.createElement("strong",null,"Выбор пользователя:"),e.createElement("ul",{className:"lk-list",style:{overflow:"hidden",maxWidth:"15rem"}},e.createElement("li",null,"Имя пользователя: ",`${E.username}`),e.createElement("li",null,"Видео включено: ",`${E.videoEnabled}`),e.createElement("li",null,"Аудио включено: ",`${E.audioEnabled}`),e.createElement("li",null,"Видео-устройство: ",`${E.videoDeviceId}`),e.createElement("li",null,"Аудио-устройство: ",`${E.audioDeviceId}`))))}function yt({props:t}){const{dispatch:a,state:n}=f.useLayoutContext().widget,r="lk-button lk-settings-toggle";return{mergedProps:e.useMemo(()=>f.mergeProps(t,{className:r,onClick:()=>{a&&a({msg:"toggle_settings"})},"aria-pressed":n!=null&&n.showSettings?"true":"false"}),[t,r,a,n])}}const Rt=e.forwardRef(function(a,n){const{mergedProps:r}=yt({props:a});return e.createElement("button",{ref:n,...r},a.children)}),It=t=>{switch(t){case k.Track.Source.Camera:return 1;case k.Track.Source.Microphone:return 2;case k.Track.Source.ScreenShare:return 3;default:return 0}};function pe({variation:t,controls:a,saveUserChoices:n=!0,onDeviceError:r,...c}){var z;const[s,u]=e.useState(!1),l=f.useMaybeLayoutContext();e.useEffect(()=>{var y,x;((y=l==null?void 0:l.widget.state)==null?void 0:y.showChat)!==void 0&&u((x=l==null?void 0:l.widget.state)==null?void 0:x.showChat)},[(z=l==null?void 0:l.widget.state)==null?void 0:z.showChat]);const v=lt(`(max-width: ${s?1e3:760}px)`)?"minimal":"verbose";t??(t=v);const o={leave:!0,...a},p=f.useLocalParticipantPermissions();if(!p)o.camera=!1,o.chat=!1,o.microphone=!1,o.screenShare=!1;else{const y=x=>p.canPublish&&(p.canPublishSources.length===0||p.canPublishSources.includes(It(x)));o.camera??(o.camera=y(k.Track.Source.Camera)),o.microphone??(o.microphone=y(k.Track.Source.Microphone)),o.screenShare??(o.screenShare=y(k.Track.Source.ScreenShare)),o.chat??(o.chat=p.canPublishData&&(a==null?void 0:a.chat))}const m=e.useMemo(()=>t==="minimal"||t==="verbose",[t]),w=e.useMemo(()=>t==="textOnly"||t==="verbose",[t]),h=S.supportsScreenSharing(),[g,d]=e.useState(!1),C=e.useCallback(y=>{d(y)},[d]),E=f.mergeProps$1({className:"lk-control-bar"},c),{saveAudioInputEnabled:I,saveVideoInputEnabled:R,saveAudioInputDeviceId:b,saveVideoInputDeviceId:M}=f.usePersistentUserChoices({preventSave:!n}),T=e.useCallback((y,x)=>x?I(y):null,[I]),P=e.useCallback((y,x)=>x?R(y):null,[R]);return e.createElement("div",{...E},o.microphone&&e.createElement("div",{className:"lk-button-group"},e.createElement(Z,{source:k.Track.Source.Microphone,showIcon:m,onChange:T,onDeviceError:y=>r==null?void 0:r({source:k.Track.Source.Microphone,error:y})},w&&"Микрофон"),e.createElement("div",{className:"lk-button-group-menu"},e.createElement(U,{kind:"audioinput",onActiveDeviceChange:(y,x)=>b(x??"default")}))),o.camera&&e.createElement("div",{className:"lk-button-group"},e.createElement(Z,{source:k.Track.Source.Camera,showIcon:m,onChange:P,onDeviceError:y=>r==null?void 0:r({source:k.Track.Source.Camera,error:y})},w&&"Камера"),e.createElement("div",{className:"lk-button-group-menu"},e.createElement(U,{kind:"videoinput",onActiveDeviceChange:(y,x)=>M(x??"default")}))),o.screenShare&&h&&e.createElement(Z,{source:k.Track.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:m,onChange:C,onDeviceError:y=>r==null?void 0:r({source:k.Track.Source.ScreenShare,error:y})},w&&(g?"Остановить показ экрана":"Поделиться экраном")),o.chat&&e.createElement(le,null,m&&e.createElement(Ie,null),w&&"Чат"),o.settings&&e.createElement(Rt,null,m&&e.createElement(Ne,null),w&&"Настройки"),o.leave&&e.createElement(ie,null,m&&e.createElement(xe,null),w&&"Выйти"),e.createElement(se,null))}function Pt({chatMessageFormatter:t,chatMessageDecoder:a,chatMessageEncoder:n,SettingsComponent:r,...c}){var h,g;const[s,u]=e.useState({showChat:!1,unreadMessages:0,showSettings:!1}),l=e.useRef(null),i=f.useTracks([{source:k.Track.Source.Camera,withPlaceholder:!0},{source:k.Track.Source.ScreenShare,withPlaceholder:!1}],{updateOnlyOn:[k.RoomEvent.ActiveSpeakersChanged],onlySubscribed:!1}),v=d=>{S.log.debug("updating widget state",d),u(d)},o=f.useCreateLayoutContext(),p=i.filter(S.isTrackReference).filter(d=>d.publication.source===k.Track.Source.ScreenShare),m=(h=f.usePinnedTracks(o))==null?void 0:h[0],w=i.filter(d=>!S.isEqualTrackRef(d,m));return e.useEffect(()=>{var d,C,E,I,R,b;if(p.some(M=>M.publication.isSubscribed)&&l.current===null?(S.log.debug("Auto set screen share focus:",{newScreenShareTrack:p[0]}),(C=(d=o.pin).dispatch)==null||C.call(d,{msg:"set_pin",trackReference:p[0]}),l.current=p[0]):l.current&&!p.some(M=>{var T,P;return M.publication.trackSid===((P=(T=l.current)==null?void 0:T.publication)==null?void 0:P.trackSid)})&&(S.log.debug("Auto clearing screen share focus."),(I=(E=o.pin).dispatch)==null||I.call(E,{msg:"clear_pin"}),l.current=null),m&&!S.isTrackReference(m)){const M=i.find(T=>T.participant.identity===m.participant.identity&&T.source===m.source);M!==m&&S.isTrackReference(M)&&((b=(R=o.pin).dispatch)==null||b.call(R,{msg:"set_pin",trackReference:M}))}},[p.map(d=>`${d.publication.trackSid}_${d.publication.isSubscribed}`).join(),(g=m==null?void 0:m.publication)==null?void 0:g.trackSid,i]),ve(),e.createElement("div",{className:"lk-video-conference",...c},S.isWeb()&&e.createElement(fe,{value:o,onWidgetChange:v},e.createElement("div",{className:"lk-video-conference-inner"},m?e.createElement("div",{className:"lk-focus-layout-wrapper"},e.createElement(We,null,e.createElement(Je,{tracks:w},e.createElement(J,null)),m&&e.createElement(Qe,{trackRef:m}))):e.createElement("div",{className:"lk-grid-layout-wrapper"},e.createElement(Ge,{tracks:i},e.createElement(J,null))),e.createElement(pe,{controls:{chat:!0,settings:!!r}})),e.createElement(ge,{style:{display:s.showChat?"grid":"none"},messageFormatter:t,messageEncoder:n,messageDecoder:a}),r&&e.createElement("div",{className:"lk-settings-menu-modal",style:{display:s.showSettings?"block":"none"}},e.createElement(r,null))),e.createElement(Xe,null),e.createElement(tt,null))}function Nt({...t}){const[a,n]=e.useState({showChat:!1,unreadMessages:0}),r=f.useTracks([k.Track.Source.Microphone]);return ve(),e.createElement(fe,{onWidgetChange:n},e.createElement("div",{className:"lk-audio-conference",...t},e.createElement("div",{className:"lk-audio-conference-stage"},e.createElement(Y,{tracks:r},e.createElement(et,null))),e.createElement(pe,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),a.showChat&&e.createElement(ge,null)))}function xt({controls:t,saveUserChoices:a=!0,onDeviceError:n,...r}){const c={leave:!0,microphone:!0,...t},s=f.useLocalParticipantPermissions(),{microphoneTrack:u,localParticipant:l}=S.useLocalParticipant(),i=e.useMemo(()=>({participant:l,source:k.Track.Source.Microphone,publication:u}),[l,u]);s?c.microphone??(c.microphone=s.canPublish):c.microphone=!1;const v=f.mergeProps$1({className:"lk-agent-control-bar"},r),{saveAudioInputEnabled:o,saveAudioInputDeviceId:p}=f.usePersistentUserChoices({preventSave:!a}),m=e.useCallback((w,h)=>{h&&o(w)},[o]);return e.createElement("div",{...v},c.microphone&&e.createElement("div",{className:"lk-button-group"},e.createElement(Z,{source:k.Track.Source.Microphone,showIcon:!0,onChange:m,onDeviceError:w=>n==null?void 0:n({source:k.Track.Source.Microphone,error:w})},e.createElement(he,{trackRef:i,barCount:7,options:{minHeight:5}})),e.createElement("div",{className:"lk-button-group-menu"},e.createElement(U,{kind:"audioinput",onActiveDeviceChange:(w,h)=>p(h??"default")}))),c.leave&&e.createElement(ie,null,"Отключиться"),e.createElement(se,null))}exports.AudioConference=Nt;exports.AudioTrack=X;exports.BarVisualizer=he;exports.CarouselLayout=Je;exports.Chat=ge;exports.ChatEntry=nt;exports.ChatToggle=le;exports.ConnectionQualityIndicator=ue;exports.ConnectionStateToast=tt;exports.ControlBar=pe;exports.DisconnectButton=ie;exports.FocusLayout=Qe;exports.FocusLayoutContainer=We;exports.FocusToggle=_e;exports.GridLayout=Ge;exports.LKFeatureContext=Ce;exports.LayoutContextProvider=fe;exports.MediaDeviceMenu=U;exports.MediaDeviceSelect=G;exports.ParticipantAudioTile=et;exports.ParticipantContextIfNeeded=Ue;exports.ParticipantName=K;exports.ParticipantTile=J;exports.PreJoin=Tt;exports.RoomAudioRenderer=Xe;exports.StartMediaButton=se;exports.SvgCameraDisabledIcon=Te;exports.SvgCameraIcon=ye;exports.SvgChatCloseIcon=Re;exports.SvgChatIcon=Ie;exports.SvgChevron=re;exports.SvgFocusToggleIcon=Pe;exports.SvgGearIcon=Ne;exports.SvgLeaveIcon=xe;exports.SvgLockLockedIcon=Le;exports.SvgMicDisabledIcon=Ae;exports.SvgMicIcon=Ve;exports.SvgParticipantPlaceholder=me;exports.SvgQualityExcellentIcon=Fe;exports.SvgQualityGoodIcon=De;exports.SvgQualityPoorIcon=ze;exports.SvgQualityUnknownIcon=Oe;exports.SvgScreenShareIcon=oe;exports.SvgScreenShareStopIcon=$e;exports.SvgSpinnerIcon=ce;exports.SvgUnfocusToggleIcon=Ze;exports.Toast=Ye;exports.TrackLoop=Y;exports.TrackMutedIndicator=de;exports.TrackRefContextIfNeeded=qe;exports.TrackToggle=Z;exports.VideoConference=Pt;exports.VideoTrack=He;exports.VoiceAssistantControlBar=xt;exports.formatChatMessageLinks=Ct;exports.useFeatureContext=Me;exports.usePreviewDevice=Mt;exports.usePreviewTracks=at;
//# sourceMappingURL=shared-DPwWR9E3.js.map
